---
layout: post
title: Kafka - 2!
subtitle: kafka 책 읽기
categories: kafka
tags: [kafka]
---

## 카프카 브로커, 클러스터, 주키퍼

- __카프카 브로커__ : 데이터를 주고받기 위해 사용하는 주체, 데이터를 분산 저장하여 장애 대응 애플리케이션
- 안전한 데이터 보관 및 처리를 위해 3대 이상의 브로커를 1개의 클러스터로 운영 권장
- 클러스터는 프로듀서에서 전송된 데이터를 안전하게 `분산, 복제`를 수행

![image](https://user-images.githubusercontent.com/62547169/165308507-aa71eb46-d31b-4e66-b445-094185921ab8.png)


### 데이터 저장, 전송

![image](https://user-images.githubusercontent.com/62547169/165309960-256d5658-85b3-483d-b9df-fcf2522c1bd5.png)

- server.properties : log.dirs : /data
- 브로커는 프로듀서로부터 전달받은 데이터를 토픽의 파티션에 데이터를 저장
- 토픽의 갯수 = 디렉토리의 갯수

#### 페이지 캐시

```
카프카는 메모리, 데이터베이스에 데이터를 저장하지 않는다. - 파일 시스템 이용
지속적인 입출력이 발생할 때, 파일 시스템은 처리 속도가 늦어지는 현상 발생
카프카에서는 페이지 캐시를 이용하여서 디스크 입출력 속도를 높여 문제를 해결
```
- 메인 메모리의 남는 공간을 활용해 페이지 캐시라는 메모리 공간을 마련
- 파일 I/O의 성능을 향상시키기 위해 사용되는 것
- 사용된 파일의 내용을 저장해 놓았다가 읽을 때 page cache를 활용하여 효율 증가


### 데이터 복제, 싱크

![image](https://user-images.githubusercontent.com/62547169/165312760-ac14a4c4-18d4-4f5f-941d-d7242466307e.png)


- 데이터 복제 : 장애 허용 시스템으로 동작하도록 하는 원동력 -> 장애, 데이터 유실 대응
- 토픽 생성시 복제의 개수 설정 가능 (옵션 미선택 시 브로커 설정 옵션)
- 토픽 생성시 복제의 개수 설정 가능 (옵션 미선택 시 브로커 설정 옵션)
- 팔로워와 
